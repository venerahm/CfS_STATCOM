knitr::opts_chunk$set(echo = TRUE)
data = read_excel("./Data/23-24 CFSN Student Feedback Survey + Mentor Assistance (Responses).xlsx")
library(readxl)
data = read_excel("./Data/23-24 CFSN Student Feedback Survey + Mentor Assistance (Responses).xlsx")
multiplesheets <- function(fname) {
# getting info about all excel sheets
sheets <- readxl::excel_sheets(fname)
tibble <- lapply(sheets, function(x) readxl::read_excel(fname, sheet = x))
data_frame <- lapply(tibble, as.data.frame)
# assigning names to data frames
# names(data_frame) <- sheets
# print data frame
# print(data_frame)
}
data = multiplesheets("./Data/23-24 CFSN Student Feedback Survey + Mentor Assistance (Responses).xlsx")
data[[1]]
for (column_index in 17:28){
likert = unlist(lapply(data, function(df) df[column_index]))
print(colnames(data[[1]])[column_index])
col_name = colnames(data[[1]])[column_index]
freq_table = table(likert)
print(freq_table)
}
for (column_index in 17:19){
likert = unlist(lapply(data, function(df) df[column_index]))
print(colnames(data[[1]])[column_index])
print(table(likert))
# Get the column name
col_name <- colnames(data[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Agree', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
# Save the figure
file_name = paste0(column_index, '_grouped_', title_text, 'png')
# png(file_name, width = 800, height = 600)
# Create the percent bar plot with all categories
barplot(
percent_table_grouped,
main = title_text,
xlab = 'Response',
ylab = 'Percentage (%)',
ylim = c(0, 100),  # Set y-axis limit to 100%
names.arg = c('Strongly Disagree or Disagree', 'Neutral', 'Agree or Strongly Agree'),   # Ensure x-axis shows all options 1-5
col = 'lightblue'
)
# dev.off()
}
for (column_index in 17:19){
likert = unlist(lapply(data, function(df) df[column_index]))
print(colnames(data[[1]])[column_index])
print(table(likert))
# Get the column name
col_name <- colnames(data[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Agree', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
print(percent_table_grouped)
}
for (column_index in 17:19){
likert = unlist(lapply(data, function(df) df[column_index]))
print(colnames(data[[1]])[column_index])
# print(table(likert))
# Get the column name
col_name <- colnames(data[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Agree', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
print(percent_table_grouped)
}
for (column_index in 17:28){
likert = unlist(lapply(data, function(df) df[column_index]))
print(colnames(data[[1]])[column_index])
print(table(likert))
# Get the column name
col_name <- colnames(data[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Agree', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
# Save the figure
file_name = paste0(column_index, '_grouped_', title_text, 'png')
# png(file_name, width = 800, height = 600)
# Create the percent bar plot with all categories
barplot(
percent_table_grouped,
main = title_text,
xlab = 'Response',
ylab = 'Percentage (%)',
ylim = c(0, 100),  # Set y-axis limit to 100%
names.arg = c('Strongly Disagree or Disagree', 'Neutral', 'Agree or Strongly Agree'),   # Ensure x-axis shows all options 1-5
col = 'lightblue'
)
# dev.off()
}
for (column_index in 17:28){
likert = unlist(lapply(data, function(df) df[column_index]))
print(colnames(data[[1]])[column_index])
# print(table(likert))
# Get the column name
col_name <- colnames(data[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Agree', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
print(percent_table_grouped)
}
mentor = multiplesheets("./Data/CFSN Mentor Feedback Survey 23-24 (Responses).xlsx")
for (column_index in 4:14){
likert = unlist(lapply(mentor, function(df) df[column_index]))
print(colnames(mentor[[1]])[column_index])
# print(table(likert))
# Get the column name
col_name <- colnames(data[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Agree', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
print(percent_table_grouped)
}
for (column_index in 4:14){
likert = unlist(lapply(mentor, function(df) df[column_index]))
print(colnames(mentor[[1]])[column_index])
# print(table(likert))
# Get the column name
col_name <- colnames(mentor[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Agree', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
print(percent_table_grouped)
}
colnames(mentor)
colnames(mentor[[1]])
family  = multiplesheets("./Data/CFSN Family Feedback Survey 23-24 (Responses).xlsx")
family
length(family)
family[[1]]
colnames(family[[1]])
for (column_index in 6:14){
likert = unlist(lapply(family, function(df) df[column_index]))
print(colnames(mentor[[1]])[column_index])
# print(table(likert))
# Get the column name
col_name <- colnames(family[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Agree', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
print(percent_table_grouped)
}
for (column_index in 30:38){
likert = unlist(lapply(family, function(df) df[column_index]))
print(colnames(mentor[[1]])[column_index])
# print(table(likert))
# Get the column name
col_name <- colnames(family[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Agree', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
print(percent_table_grouped)
}
for (column_index in 30:38){
likert = unlist(lapply(family, function(df) df[column_index]))
print(colnames(family[[1]])[column_index])
# print(table(likert))
# Get the column name
col_name <- colnames(family[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Agree', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
print(percent_table_grouped)
}
for (column_index in 30:38){
likert = unlist(lapply(family, function(df) df[column_index]))
print(colnames(family[[1]])[column_index])
# print(table(likert))
# Get the column name
col_name <- colnames(family[[1]])[column_index]
# Extract the text inside square brackets
# title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Agree', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
print(percent_table_grouped)
}
family[[1]][30]
for (column_index in 6:14){
likert = unlist(lapply(family, function(df) df[column_index]))
print(colnames(family[[1]])[column_index])
# print(table(likert))
# Get the column name
col_name <- colnames(family[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Agree', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
print(percent_table_grouped)
}
length(famiy[[1]])
length(family[[1]])
length(family[[2]])
length(family[[3]])
nrow(family[[1]])
nrow(family[[2]])
nrow(family[[3]])
nrow(family[[4]])
family[[4]]
summary(likert)
11/42
11/21
17/21
likert = unlist(lapply(family, function(df) df[column_index]))
likert
likert[27]
table(likert)
percent_table
17/21
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
percent_table_grouped
column_index = 6
likert = unlist(lapply(family, function(df) df[column_index]))
table(likert)
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Agree', '5 - Strongly Agree'))
freq_table <- table(likert)
freq_table
21.23
21/23
column_index = 8
likert = unlist(lapply(family, function(df) df[column_index]))
table(likert)
14/24
19/21
for (column_index in 6:14){
likert = unlist(lapply(family, function(df) df[column_index]))
print(colnames(family[[1]])[column_index])
# print(table(likert))
print(table(likert))
# # Get the column name
# col_name <- colnames(family[[1]])[column_index]
#
# # Extract the text inside square brackets
# title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
#
# # Set factor levels to include all response options from 1 to 5
# likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Agree', '5 - Strongly Agree'))
#
# # Create a frequency table and convert to percentages
# freq_table <- table(likert)
# percent_table <- (freq_table / sum(freq_table)) * 100
#
# percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
#
# print(percent_table_grouped)
}
for (column_index in 6:14){
likert = unlist(lapply(family, function(df) df[column_index]))
print(colnames(family[[1]])[column_index])
# print(table(likert))
print(table(likert))
# Get the column name
col_name <- colnames(family[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Estar de acuerdo', '4 - Agree', '5 - Totalmente de acuerdo', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
print(percent_table_grouped)
}
for (column_index in 6:14){
likert = unlist(lapply(family, function(df) df[column_index]))
print(colnames(family[[1]])[column_index])
# print(table(likert))
print(table(likert))
# Get the column name
col_name <- colnames(family[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Estar de acuerdo', '4 - Agree', '5 - Totalmente de acuerdo', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5], percent_table[6] + percent_table[7])
print(percent_table_grouped)
}
24/26
10/26
14/26
for (column_index in 6:14){
likert = unlist(lapply(family, function(df) df[column_index]))
print(colnames(family[[1]])[column_index])
# print(table(likert))
print(table(likert))
# Get the column name
col_name <- colnames(family[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Estar de acuerdo', '4 - Agree', '5 - Totalmente de acuerdo', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5] + percent_table[6] + percent_table[7])
print(percent_table_grouped)
}
for (column_index in 6:14){
likert = unlist(lapply(family, function(df) df[column_index]))
print(colnames(family[[1]])[column_index])
# print(table(likert))
print(table(likert))
# Get the column name
col_name <- colnames(family[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Estar de acuerdo', '4 - Agree', '5 - Totalmente de acuerdo', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5], percent_table[6] + percent_table[7])
print(percent_table_grouped)
}
10/26
16/26
14/26
11/24
6/21
11/21
17/21
for (column_index in 6:14){
likert = unlist(lapply(family, function(df) df[column_index]))
print(colnames(family[[1]])[column_index])
# print(table(likert))
print(table(likert))
# Get the column name
col_name <- colnames(family[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Estar de acuerdo', '4 - Agree', '5 - Totalmente de acuerdo', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5] + percent_table[6] + percent_table[7])
print(percent_table_grouped)
}
partner  = multiplesheets("./Data/CFSN Partner Survey (Responses) (2022 and 2024).xlsx")
colnames(partner[[1]])
for (column_index in 7:13){
likert = unlist(lapply(partner, function(df) df[column_index]))
print(colnames(partner[[1]])[column_index])
# print(table(likert))
# Get the column name
col_name <- colnames(partner[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Agree', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
print(percent_table_grouped)
}
for (column_index in 7:13){
likert = unlist(lapply(partner, function(df) df[column_index]))
print(colnames(partner[[1]])[column_index])
# print(table(likert))
# Get the column name
col_name <- colnames(partner[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Agree', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
print(percent_table)
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
# print(percent_table_grouped)
}
partner[[1]]
for (column_index in 7:13){
likert = unlist(lapply(partner, function(df) df[column_index]))
print(colnames(partner[[1]])[column_index])
# print(table(likert))
# Get the column name
col_name <- colnames(partner[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Agree', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
# print(percent_table_grouped)
}
for (column_index in 7:13){
likert = unlist(lapply(partner, function(df) df[column_index]))
print(colnames(partner[[1]])[column_index])
# print(table(likert))
# Get the column name
col_name <- colnames(partner[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Agree', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
print(percent_table_grouped)
}
table(likert)
30/32
for (column_index in 7:13){
likert = unlist(lapply(partner, function(df) df[column_index]))
print(colnames(partner[[1]])[column_index])
# print(table(likert))
# Get the column name
col_name <- colnames(partner[[1]])[column_index]
# Extract the text inside square brackets
title_text <- sub(".*\\[(.*)\\].*", "\\1", col_name)
# Set factor levels to include all response options from 1 to 5
likert <- factor(likert, levels = c('1 - Strongly Disagree',  '2 - Disagree', '3 - Neutral', '4 - Agree', '5 - Strongly Agree'))
# Create a frequency table and convert to percentages
freq_table <- table(likert)
percent_table <- (freq_table / sum(freq_table)) * 100
percent_table_grouped = c(percent_table[1] + percent_table[2], percent_table[3], percent_table[4] + percent_table[5])
print(percent_table_grouped)
}
